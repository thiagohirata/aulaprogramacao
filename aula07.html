<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/prism.css"  />
	<link rel="stylesheet" href="css/codemirror.css"  />
  <link rel="stylesheet" href="css/laboratorio.css"  />
	<title>Técnicas de programação para Games - Aula 7 - Um protótipo de Game Engine</title>
</head>
<body>
	<nav class="navbar navbar-default navbar-static-top">
		<div class="container-fluid">
			<a class="navbar-brand" href="index.html">TPG 2016</a>
			<div class="pull-right">
				<p class="navbar-text userdata hidden"><span class="username">{nome}</span> <small>(<a href="#" class="onclick-logout">sair</a>)</small></p>
			</div>
		</div>
	</nav>

<div class="container">
  <h1>Aula 7 - Um protótipo de Game Engine</h1>

	<section>
		<h2>O Game Loop</h2>
		<p><img src="aula07/gameloop.png" class="img-responsive"/></p>
		<h3>Pseudo código</h3>
		<pre><code class="language-javascript autoprism">init();
while (true)
{
	var start = getCurrentTime();
	processInput();
	update();
	render();
	sleep(start + MS_PER_FRAME - getCurrentTime());
}</code></pre>
		<div class="alert alert-info">
			<strong>Atenção:</strong> Em um ambiente JavaScript rodando em um browser,
			um script não funciona assim. Quando um trecho de código é executado, o
			browser "trava" - e o conteúdo só é atualizado quando o trecho de código
			chegar ao fim.
		</div>
	</section>


	<section>
		<h2>Uma animação</h2>
		<div class="row">
			<div class="col-sm-6"><pre><code class="language-javascript autoprism">//modelo
var x = 0;
var speed = 5;

//renderização da cena
function processingCode(processing) {

		processing.draw = function() {
			processing.background(0);
			processing.ellipse(x, 250, 50, 50);
		};
		processing.setup = function() {
			processing.size(500, 500);
			processing.noStroke();
		};
}

//executado a cada game loop
function update() {
	x += speed;
	if (speed > 0 &amp;&amp; x > 500) {
		speed *= -1.01;
	} else if(speed < 0 &amp;&amp; x < 0){
		speed *= -1.01;
	}
}

//inicia o processingJS
new Processing($('#exemplo-1')[0], processingCode);
//executa update 60 vezes por segundo
setInterval(update, 1000/60);</code></pre></div>
			<div class="col-sm-6"><canvas id="exemplo-1"></canvas></div>
		</div>
	</section>

	<section>
		<h2>Referências</h2>
		<ul>
			<li><a href="http://gameprogrammingpatterns.com/game-loop.html">Game Programming Patterns - Game Loop - NYSTROM, Robert</a></li>
		</ul>
	</section>

</div>

<script src="https://www.gstatic.com/firebasejs/3.1.0/firebase.js"></script>
<script src="https://www.gstatic.com/firebasejs/ui/live/0.4/firebase-ui-auth.js"></script>
<script src="js/jquery-3.0.0.min.js"></script>
<script src="js/prism.js" data-manual></script>
<script src="js/processing.min.js"></script>
<script src="js/codemirror.js"></script>
<script src="js/codemirror/mode/javascript/javascript.js"></script>
<script src="js/laboratorio.js"></script>
<script src="js/appsetup.js"></script>
<script>
	$(function() {
		//modelo
		var x = 0;
		var speed = 5;

		//renderização da cena
		function processingCode(processing) {

				processing.draw = function() {
					processing.background(0);
					processing.ellipse(x, 250, 50, 50);
				};
				processing.setup = function() {
					processing.size(500, 500);
					processing.noStroke();
				};
		}

		//executado a cada game loop
		function update() {
			x += speed;
			if (speed > 0 && x > 500) {
				speed *= -1.01;
			} else if(speed < 0 && x < 0){
				speed *= -1.01;
			}
		}

		new Processing($('#exemplo-1')[0], processingCode);
		setInterval(update, 1000/60);
	});
</script>

</body>
</html>
